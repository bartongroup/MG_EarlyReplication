{\rtf1\ansi\ansicpg1252\cocoartf2639
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica-Bold;\f1\fswiss\fcharset0 Helvetica;\f2\fswiss\fcharset0 Helvetica-BoldOblique;
\f3\fswiss\fcharset0 Helvetica-Oblique;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
{\info
{\author Julian Blow (Staff)}}\paperw11900\paperh16840\margl1440\margr1440\vieww26860\viewh17140\viewkind1\viewscale140
\deftab720
\pard\pardeftab720\ri0\partightenfactor0

\f0\b\fs24 \cf0 READ_ME\
\pard\pardeftab720\ri0\partightenfactor0

\f1\b0 \cf0 \
How to use the ReplicationWavelet application.\
\
Two data sources are required: \
i) the early replication timing data in .tsv files from either of two experimental sets (E2 or E3) which are collated into 10 kb or 50 kb bins (gbg_10k.tsv and gbg_50k.tsv, created in \'91tab\'92 subdirectory of the main project, by targets pipeline)\
ii) the timing domain data from the Gilbert lab, in RT_U2OS_Bone.txt\
All of the data for the paper was derived from the E2 experiments.\
\
After you have built and launched the application, the main window is presented. To prepare for the analysis:\
\'95 Click on the Load Replication Data button; you will then be prompted to locate the early replication data file and then the timing domain data file.\
\'95 Select an available Data Set from the pulldown menu. The six data sets analysed in the paper are TM_0-40, TM_0-130, TM_10-40, TM_40-70, TM_70-100 and TM_100-130; the first number is the start of the EdU pulse and the second number is the end of the pulse (minutes relative to the time of mimosine release).\
\'95 Set the wavelet peak width in kb (note that the peak width is 22.5% of the total width of the Ricker wavelet as shown in Supp Figure S4). \
\
There are two analysis sections: on the left is \'91Regional Analysis\'92 to look at a specified region of the genome, and on the right is \'91Genome-wide Metrics\'92 to provide metrics for the entire genome.\
\
\pard\pardeftab720\ri0\partightenfactor0

\f0\b \cf0 Regional Analysis\
\pard\pardeftab720\ri0\partightenfactor0

\f1\b0 \cf0 To select a region for analysis type in a chromosome name in the \'91Chromosome\'92 text box, using chr1 to chr22 or chrX. Specify the region of interest in Mbp. Set cutoff in the \'91Cutoff %tile of late replicating peaks box\'92; as shown in Figure 4c of the paper and described in the main text this sets the minimum size for a peak to be recognised, expressed as the percentile of the peaks observed in late replicating domains. Optionally check/uncheck the \'91show wavelets\'92 box to see/hide the associated wavelets (red lines) and peak cutoff (dashed black line). Then the different buttons act as follows:\
\'95 
\f2\i\b Visualise
\f1\i0\b0 : shows the replication signal in the specified region\
\'95 
\f2\i\b Heatmap
\f1\i0\b0 : performs a scan of wavelet peak widths (50, 70.7, 100, 141, 200, 283, 400, 566, 800, 1131, 1600, 2263, 3200, 4525,6 400, 9051, 12800, 18102, 25600, 36204 and 51200 kb) and displays the result as a heatmap.\
\'95 
\f2\i\b Timing Domains
\f1\i0\b0 : shows the timing domain data from the Gilbert lab for the region.\
\'95 
\f2\i\b Optimal wavelet for single peak
\f1\i0\b0 : evaluates the best-fitting wavelet for the region from all wavelet peak withs from 200 kb to 1200 kb in 25 kb steps.\
\'95 
\f2\i\b Fit FTGauss to single peak
\f1\i0\b0 : fits a flat-topped Gaussian curve to the region; this analysis is not used in the paper so will not be described further.\
\'95 
\f2\i\b Fit Gaussian to single peak
\f1\i0\b0 : uses a Nelder-Mead optimisation to fit a Gaussian curve to the region, for the four individual timepoints analysed in the paper (TM_10-40, TM_40-70, TM_70-100 and TM_100-130). To give a satisfactory peak fitting, this requires that the specified region contains only a single main peak.\
\pard\pardeftab720\ri0\partightenfactor0

\f0\b \cf0 \
Genome-wide Metrics\
\pard\pardeftab720\ri0\partightenfactor0

\f1\b0 \cf0 The different buttons act as follows:\
\'95 
\f2\i\b Early v late replication signals
\f1\i0\b0 : calculates the total EdU replication signal that lies within either the early timing domains or late timing domains as determined by the Gilbert timing data.\
\'95  
\f2\i\b Peaks with wavelet width sweep
\f1\i0\b0 : performs a wavelet analysis on early timing domain regions with wavelet peak widths of 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 1000, 1500, and 3000 kb, and analyses all the peaks whose height exceeds the cutoff threshold. Four graphs are produced: i) the mean height of the peaks, ii) the median height of the peaks, iii) the sum of the peak heights, and iv) the number of peaks. The mean height data is shown in Figures 4a and 4b in the paper.\
\'95 
\f2\i\b Peak data sweep %ile
\f1\i0\b0 : identifies wavelet peaks in early timing domain regions using the specified wavelet peak width and then examines the effect of changing the percent cutoff that defines whether a peak is called or not. The cutoff height is expressed as a percentile of all the peaks identified in late replicating domains, as described in the main text. Three graphs are produced showing the peaks called in early timing domains using different percentiles of the peaks in late timing domains: i) the number of peaks called, ii) the mean height of all peaks called, and iii) the median height of all peaks called. This data is shown in Figure 4c in the paper.\
\'95 
\f2\i\b Early peak heights
\f1\i0\b0 : identifies wavelet peaks in early timing domain regions using the specified wavelet peak width and the specified percentile cutoff; the distribution of peak heights is plotted. This data is shown in Figure 4d in the paper.\
\'95 
\f2\i\b Early peak separations
\f1\i0\b0 : first identifies wavelet peaks in early timing domain regions using the specified wavelet peak width and the specified percentile cutoff and then calculates the separations between peaks that lie in a single timing domain. This data is shown in Figure 5a in the paper.\
\'95 
\f2\i\b Peaks per early timing domain
\f1\i0\b0 : identifies wavelet peaks in early timing domains using the specified wavelet peak width and the specified percentile cutoff; the scatterplot plots the number of peaks in each timing domain against the size of the timing domain. This data is shown in Figure 5b in the paper.\
\'95 
\f2\i\b Auto isolated peak growth \'96 wavelet
\f1\i0\b0 : identifies all wavelet peaks in early timing domains using the specified wavelet peak width and the specified percentile cutoff that are 'isolated\'92 as defined in the paper - meaning that the total replication signal for a distance of one wavelet peak width on either side of the peak is less than 25% of the signal under the wavelet peak. For each peak, the peak region is analysed in the four timepoints used in the paper (TM_10-40, TM_40-70, TM_70-100 and TM_100-130) each which is subject to wavelet analysis using wavelet peak widths in 25 kb steps from 200 kb to 1200 kb to find the optimal wavelet width on the peak in this region. If a peak is identified that has a width of more than 200 kb and less than 1200 kb, the peak width is recorded. A .tsv file is produced with the optimal wavelet peak width for each \'91isolated\'92 peak over the four time points. For peaks identified in all four timepoints, graphs are produced showing: i) the distribution of widths at each time point, and ii) the change in width of each peak between successive time points. This data is shown in Figures 6, 7c and 7e and Supp Figure S5 in the paper.\
\'95 
\f2\i\b Manual isolated peak growth \'96 wavelet
\f1\i0\b0 : requests a .tsv file where each line represents a manually identified \'91isolated\'92 peak defined as chromosome_name-tab-start_Mbp-tab-end_Mbp. These peaks are then analysed in the same way as the isolated peaks in 
\f3\i \'91Auto isolated peak growth \'96 wavelet\'92
\f1\i0 . This analysis is not shown in the paper.\
\'95 
\f2\i\b Auto isolated peak growth \'96 Gaussian
\f1\i0\b0 : Isolated peaks are identified as in 
\f3\i \'91Auto isolated peak growth \'96 wavelet\'92
\f1\i0  and are processed in the same way except that the peak width is obtained by using a Nelder-Mead optimisation to fit a Gaussian curve to the region. This data is shown in Figures 6, 7d and 7f and Supp Figure S5 in the paper.\
\'95 
\f2\i\b Manual isolated peak growth \'96 Gaussian
\f1\i0\b0 : isolated peaks are manually defined as in 
\f3\i Manual isolated peak growth \'96 wavelet
\f1\i0  and are then analysed as described for 
\f3\i Auto isolated peak growth \'96 Gaussian. 
\f1\i0 This analysis is not shown in the paper.\
\'95 
\f2\i\b Valley filling
\f1\i0\b0 : identifies wavelet peaks in early timing domain regions in the TM_10-40 data set using the specified wavelet peak width and the specified percentile cutoff; 'valleys' are then identified between the wavelet peaks as any place within a single timing domain that is flanked by two wavelet peaks, where the distance to either of the two flanking peak edges is greater than 180 kb (the distance a fork might move over 2 hours). See Figure 9a for a graphical representation. The same places are then examined for valleys in the TM_40-70, TM_70-100 and TM_100-130 time points, recording the mean and minimum valley replication signal at all four timepoints. A peak position is allowed to shift \'b1 100 kb and still be considered the 'same' peak. The mean and minimum replication signal in all valleys that are present in all four time points are then plotted. This data is shown in Figure 9b and 9c in the paper.\
\'95 
\f2\i\b Peak activation sequence
\f1\i0\b0 : identifies groups of peaks considered to be 'adjacent' - they are in the same timing domain and their peaks are less than 1.6Mbp apart; peaks in each group are then ranked by their maximum replication signals and their height order recorded (1 = highest). Because the direction the group is encountered is arbitrary, the order of the array is reversed if the largest peak was found in the second half of the group of peaks. A txt file is output, containing the height orders of all groups containing 3 or 4 peaks, plus a list of the numbers of groups with different numbers of peaks. This data is shown in Figure 10a and 10b in the paper.\
\'95 
\f2\i\b Peak neighbour similarity
\f1\i0\b0 : identifies groups of peaks considered to be 'adjacent' - they are in the same timing domain and their peaks are less than 1.6Mbp apart; it then compares the similarity in maximum replication signal between adjacent peaks using the adjacentValueSimilarityMetric described in Materials and Methods. A graph of the degree of peak ordering for all groups is output. This data is shown in Figure 10d in the paper.\
\
}